package com.isotop.demo.service.impl;


import com.alibaba.fastjson.JSONObject;
import com.isotop.demo.config.constant.ApiConstant;
import com.isotop.demo.service.IDemoService;
import com.isotop.demo.utils.HttpClientUtil;
import com.isotop.demo.utils.OpenApiUtils;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Service;
import org.web3j.abi.DefaultFunctionEncoder;
import org.web3j.abi.DefaultFunctionReturnDecoder;
import org.web3j.abi.TypeReference;
import org.web3j.abi.datatypes.Function;
import org.web3j.abi.datatypes.Type;
import org.web3j.abi.datatypes.Utf8String;
import org.web3j.abi.datatypes.generated.Uint256;

import java.util.*;

/**
 * <p>
 * CustomerAssets服务类
 * </p>
 *
 * @author Nathan
 * @since 2023-03-16
 */
@Service
@Slf4j
public class DemoServiceImpl implements IDemoService {
    @Override
    public String getDetails() {
        String result = null;
        Map<String, String> params = new HashMap<>();
        //具体查看对应链的文档 文昌测试12231 文昌正式1223  数图测试 1 数图正式1029
        params.put("chainid", "12231");
        params.put("tokenId", "1");
        params.put("contract", "0x207cd254d7a91129bf12eac251ca356061c8b642");
        //头部
        Map<String, String> headerMap = OpenApiUtils.makeHeaders(params);
        String getResult = OpenApiUtils.getRequest(ApiConstant.QUERYASSET, headerMap, params);
        log.info("--详情{}", getResult);
        /**
         * 结果例子如下
         * {"success":true,"code":"0","data":"https://s3.cn-north-1.amazonaws.com.cn/file.isotop.top/20230802/json/NFT002.json"}
         */
        JSONObject jsonObjectErrcode = JSONObject.parseObject(getResult);
        // 状态码，0成功，其他失败
        if (Objects.nonNull(jsonObjectErrcode) && jsonObjectErrcode.containsKey("code")
                && "0".equals(jsonObjectErrcode.getString("code"))) {
            String dataAsset = jsonObjectErrcode.getString("data");
            //{"success":true,"code":"0","data":"data:application/json;base64,eyJuYW1lIjogIuWkp+WSlumBkyMwIiwgImRlc2NyaXB0aW9uIjogIueyieWSliIsICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEF3SWlCb1pXbG5hSFE5SWpVd01DSWdkbWxsZDBKdmVEMGlNQ0F3SURVd01DQTFNREFpSUhOMGVXeGxQU0ppWVdOclozSnZkVzVrTFdOdmJHOXlPbVJoY210eVpXUWlJSGh0YkRwemNHRmpaVDBpY0hKbGMyVnlkbVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrUEhOMlp5QjNhV1IwYUQwaU1UQXdKU0lnYUdWcFoyaDBQU0l4TURBbElpQjJhV1YzUW05NFBTSXRNalVnTFRBZ01UVXdJREUxTUNJK0NpQWdQSE4wZVd4bFBnb2dJQ0FnSUM1aGMzUnliMjVoZFhReExXMWhiaUI3WVc1cGJXRjBhVzl1T21GemRISnZibUYxZERFdGJXRnVJRFJ6SUdsdVptbHVhWFJsTzMwS0lDQWdJQ0JBYTJWNVpuSmhiV1Z6SUdGemRISnZibUYxZERFdGJXRnVJSHNLSUNBZ0lDQWdJQ0FnTUNWN2RISmhibk5tYjNKdE9pQjBjbUZ1YzJ4aGRHVXpaQ2d3TENBdE9IQjRMQ0F3S1R0OUNpQWdJQ0FnSUNBZ0lEVXdKWHQwY21GdWMyWnZjbTA2SUhSeVlXNXpiR0YwWlROa0tEQXNJRGh3ZUN3Z01DazdmUW9nSUNBZ0lDQWdJQ0F4TURBbGUzUnlZVzV6Wm05eWJUb2dkSEpoYm5Oc1lYUmxNMlFvTUN3Z0xUaHdlQ3dnTUNrN2ZRb2dJQ0FnSUgwS0NpQWdJQ0FnTG1GemRISnZibUYxZERFdGNtbG5hSFF0YzNSaGNpQjdZVzVwYldGMGFXOXVPbUZ6ZEhKdmJtRjFkREV0Y21sbmFIUXRjM1JoY2lBMGN5QXlNREJ0Y3lCcGJtWnBibWwwWlR0OUNpQWdJQ0FnTG1GemRISnZibUYxZERFdGJHVm1kQzF6ZEdGeUlIdGhibWx0WVhScGIyNDZZWE4wY205dVlYVjBNUzF5YVdkb2RDMXpkR0Z5SURSeklEUXdNRzF6SUdsdVptbHVhWFJsTzMwS0lDQWdJQ0F1WVhOMGNtOXVZWFYwTVMxeWFXZG9kQzF6Y0dWaklIdGhibWx0WVhScGIyNDZZWE4wY205dVlYVjBNUzF5YVdkb2RDMXpkR0Z5SURSeklEWXdNRzF6SUdsdVptbHVhWFJsTzMwS0lDQWdJQ0F1WVhOMGNtOXVZWFYwTVMxc1pXWjBMWE53WldNZ2UyRnVhVzFoZEdsdmJqcGhjM1J5YjI1aGRYUXhMWEpwWjJoMExYTjBZWElnTkhNZ09EQXdiWE1nYVc1bWFXNXBkR1U3ZlFvZ0lDQWdJQzVoYzNSeWIyNWhkWFF4TFdKdmRIUnZiUzF6Y0dWaklIdGhibWx0WVhScGIyNDZZWE4wY205dVlYVjBNUzF5YVdkb2RDMXpkR0Z5SURSeklETXdNRzF6SUdsdVptbHVhWFJsTzMwS0lDQWdJQ0F1WVhOMGNtOXVZWFYwTVMxeWFXZG9kQzF5YjJOcklIdGhibWx0WVhScGIyNDZZWE4wY205dVlYVjBNUzF5YVdkb2RDMXpkR0Z5SURSeklERnpJR2x1Wm1sdWFYUmxPMzBLSUNBZ0lDQXVZWE4wY205dVlYVjBNUzFzWldaMExYSnZZMnNnZTJGdWFXMWhkR2x2YmpwaGMzUnliMjVoZFhReExYSnBaMmgwTFhOMFlYSWdOSE1nTVRJd01HMXpJR2x1Wm1sdWFYUmxPMzBLSUNBZ0lDQkFhMlY1Wm5KaGJXVnpJR0Z6ZEhKdmJtRjFkREV0Y21sbmFIUXRjM1JoY2lCN0NpQWdJQ0FnSUNBZ0lEQWxlM1J5WVc1elptOXliVG9nZEhKaGJuTnNZWFJsTTJRb01Dd2dNQ3dnTUNrN2ZRb2dJQ0FnSUNBZ0lDQTFNQ1Y3ZEhKaGJuTm1iM0p0T2lCMGNtRnVjMnhoZEdVelpDZ3dMQ0F4TUhCNExDQXdLVHQ5Q2lBZ0lDQWdJQ0FnSURFd01DVjdkSEpoYm5ObWIzSnRPaUIwY21GdWMyeGhkR1V6WkNnd0xDQXdMQ0F3S1R0OUNpQWdJQ0FnZlFvZ0lDQWdJQW9nSUNBZ0lFQnRaV1JwWVNBb2NISmxabVZ5Y3kxeVpXUjFZMlZrTFcxdmRHbHZiam9nY21Wa2RXTmxLU0I3Q2lBZ0lDQWdJQ0FnSUM1aGMzUnliMjVoZFhReExXMWhiaXdnTG1GemRISnZibUYxZERFdGNtbG5hSFF0YzNSaGNpd2dMbUZ6ZEhKdmJtRjFkREV0YkdWbWRDMXpkR0Z5TENBdVlYTjBjbTl1WVhWME1TMXlhV2RvZEMxemNHVmpMQ0F1WVhOMGNtOXVZWFYwTVMxc1pXWjBMWE53WldNc0lDNWhjM1J5YjI1aGRYUXhMV0p2ZEhSdmJTMXpjR1ZqTENBdVlYTjBjbTl1WVhWME1TMXlhV2RvZEMxeWIyTnJMQ0F1WVhOMGNtOXVZWFYwTVMxc1pXWjBMWEp2WTJzZ2V3b2dJQ0FnSUNBZ0lDQWdJQ0FnWVc1cGJXRjBhVzl1T2lCdWIyNWxPd29nSUNBZ0lDQWdJQ0I5Q2lBZ0lDQWdmUW9nSUR3dmMzUjViR1UrQ2lBZ1BHY2djM1I1YkdVOUltRnVhVzFoZEdsdmJpMWtkWEpoZEdsdmJqbzBjenRoYm1sdFlYUnBiMjQ2WVhOMGNtOXVZWFYwTVMxdFlXNGdOSE1nYVc1bWFXNXBkR1VpUGdvZ0lDQWdQSEJoZEdnZ1kyeGhjM005SW1acGJHeERiSE00SWlCa1BTSnROVGN1TmpVNElESTNMakl6TVNBNExqY3lNeUEyTGpZMU15MHhMakV3T1NBeE1DNDNPVE10TGprMk15QTNMalUzTW1FeUxqWTJOU0F5TGpZMk5TQXdJREFnTVMweExqQTRPQ0F4TGpneU9Xd3RNaTR6TkRnZ01TNDJPRGh6TFM0MU5UVWdNUzQzTnpRdE1pNHdNek1nTXk0eE1EVmpMVEV1TkRjM0lERXVNek10TXk0eE1EUWdNUzR6TXkwekxqRXdOQ0F4TGpNemRpMHhMalEzT0hNeExqQXpNeTR3TURnZ01TNDVNakl0TGpjek9XTXVPRGc0TFM0M05EZ2dNUzQwTURRdE1pNHlNVGdnTVM0ME1EUXRNaTR5TVRob0xUSXVNVFEwYkM0M05DMHlPQzQxTXpWYUlpQm1hV3hzUFNJalJESTJPVGxFSWk4K0NpQWdJQ0E4Y0dGMGFDQmpiR0Z6Y3owaVptbHNiRU5zY3pNaUlHUTlJazB5TlM0eU9DQTJOQzR4T1ROak5DNHlPRGN0TkM0NE56a2dNVE11TURFdE1UQXVORGszSURFekxqQXhMVEV3TGpRNU4yd3hPUzR5TWpFZ01TNDVNakp6TGpRNU1pQXpMalF0TVM0ME1EVWdPQzQxTnpWakxURXVNemN5SURNdU56UTBMVFV1TlRRMElEZ3VOVGMxTFRVdU5UUTBJRGd1TlRjMWN6RXVNall6SURJdU9EQTVJREV1TnlBMExqWTFOMk11TkRJMUlERXVOemszTGpVeE55QTBMalkxT0M0MU1UY2dOQzQyTlRoc0xqZzRPQ0ExTGpNeU1uTXROQzR4TkNBeUxqazFOeTAzTGpZNE9TQXpMalJqTFRFdU1UZzFMUzR5TmkweUxqZ3dPUzB4TGpBek5DMHlMamd3T1MweExqQXpOSFl0TWk0ek5qWnNNeTQwTURFdE1pNDVOVGN0TVM0ek16RXRNaTR6TmpWekxUTXVOVFE0TFRZdU5qVTBMVFF1TWpnM0xUa3VNekUxWXkwdU1qRTVMVE11TkRVeUlESXVNakUzTFRndU5UYzFJREl1TWpFM0xUZ3VOVGMxYkMwNUxqYzFPQ0EwTGpjek1YTXRNUzR4T0RJZ05pNDFNRFV0TWk0Mk5qRWdPQzQ0TnpGakxTNHpJREl1TURBMkxTNHhORGdnTlM0eE56VXRMakUwT0NBMUxqRTNOWE10TlM0ek1qSWdNaTR6TmpVdE9TNDBOaklnTVM0NU1qSmpMVEV1TlRBMkxTNDFPUzB6TGpRdE1pNHpOall0TXk0MExUSXVNelkyY3k0MU1UTXRNUzR4TWpRZ01TNHdNelV0TVM0M2JEUXVOVGd6TFRFdU4xWTNOaTQzTm5NdExqTXlNeTA0TGpFek9TQXhMamt5TWkweE1pNDFOamRhSWlCbWFXeHNQU0lqTkVZNVFrVXpJaTgrQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JFTnNjemtpSUdROUlrMDJNaTR3TXpnZ016Y3VPVFUxWXk0d05UTXRMalF4TWk0eU9UVXRMamMzTmk0Mk5UUXRMams0Tkd3dU1UTXRMakEzTldNdU9UUXlMUzQxTkRVZ01pNHhNRFV1TWpBM0lERXVPVGswSURFdU1qbHNMUzQyTXpNZ05pNHhOelZoTVM0ek16TWdNUzR6TXpNZ01DQXdJREV0TVM0ME9EVWdNUzR4T0Rkc0xTNHlOemt0TGpBek0yRXhMak16TXlBeExqTXpNeUF3SURBZ01TMHhMakUyTXkweExqUTVOR3d1TnpneUxUWXVNRFkyV20wdU1EQTRMVFV1TVRjeUxTNHhOVGt0TGpFeU9HRXhMakV3TkNBeExqRXdOQ0F3SURFZ01DMHhMak00T0NBeExqY3liQzR4TlRrdU1USTRZVEV1TVRBMUlERXVNVEExSURBZ01DQXdJREV1TXpnNExURXVOekphSWlCbWFXeHNQU0lqUWpZME1EYzBJaTgrQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JFTnNjeklpSUdROUlrMDJOeTQzTVRFZ05ETXVPVE00UXpZeExqYzVOeUF6Tmk0NE16TWdOVGN1TlRFZ016TXVNVFExSURVM0xqVXhJRE16TGpFME5VZzBNaTQwTWpsekxUUXVPREE1TFRFdU5UVTNMVGN1TWpRMExUSXVPREE1WXkwekxqTTVNeTB4TGpjME5DMDNMalUwTFRZdU1qRXROeTQxTkMwMkxqSXhjeTB6TGpJMU1pMHpMamN3TkMwekxqazVNaTB4TGpjM05HTXRNaTR3TnlBeExqUTNPUzQxT1RFZ05DNDNNekV1TlRreElEUXVOek14Y3pNdU5qazBJRFV1TlRVNElEWXVPREF4SURndU5ESTRZekl1TnpBM0lESXVOU0EzTGpZNE9DQTFMalEzSURjdU5qZzRJRFV1TkRkekxqWXhNU0EwTGpjd01pNHlPVFlnTnk0Mk9EaGpMUzR5TURrZ01TNDVPREl0TGpnNE9DQTFMakF5TnkwdU9EZzRJRFV1TURJM2N6RXVPVEl6SURJdU16YzBJRGN1T1RnMElETXVOamsyWXpZdU1EWXlJREV1TXpJeUlERXhMak00TkMweExqQXpOU0F4TVM0ek9EUXRNUzR3TXpWekxqWTBOeTB6TGpVd09TNDRPRGd0TlM0M05qWmpMakl3T1MweExqazJMakUwT0MwMUxqQXlOeTR4TkRndE5TNHdNamR6TWk0eE1UUXVOamN5SURNdU1qVXlJREV1TkRjNVl6TXVNVEEySURVdU1ERTRJRE11T1RreUlEY3VOamc0SURNdU9Ua3lJRGN1TmpnNGN6SXVNelk0SURVdU16RTBJRFV1TkRjZ015NDJPVFpqTWk0NE1TMHhMakF6TlM0eU9UZ3ROaTR3Tnk0eU9UZ3ROaTR3TjNNdE1TNDJNamN0TkM0NE56a3RNeTQ0TkRZdE9DNDBNVGxhSWlCbWFXeHNQU0lqT1RaRE5FVkRJaTgrQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JFTnNjeklpSUdROUltMDNNUzR4T0RRZ05UUXVOalV5TFM0NE1qTXRNUzR6TWpVdE1pNDFNVGdnTVM0Mk1UUXVOVEUzSURFdU1qSXlZeTR3T1RJdU1qRTNMakUxTlM0ME5ETXVNVGd6TGpZM05pNHdOREV1TXpNekxqQTVPQzQ0TkRRdU1USTBJREV1TWpZMkxqQXhNeTR5TVRrdU1EUXVORE0zTGpBNU5pNDJORGt1TVRNeExqUTVNaTR6T0RZZ01TNDBNemN1TlRZMElESXVNREV6TGpJMU15NDRNakl1TlRFMElERXVPVGsxTGpZek5DQXlMalUxTm1FdU16YzNMak0zTnlBd0lEQWdNQ0F1TXprNExqSTVOeTR6TnpNdU16Y3pJREFnTUNBd0lDNHpOREl0TGpNemJDNHhNamd0TVM0eE1UTWdNUzR5TmpZZ01pNHdPRFJoTGpRM05pNDBOellnTUNBd0lEQWdMamc0TWkwdU1qY3liQzB1TURjdE1TNHpNVElnTVM0eE9EUWdNUzQxTmpsaExqUTJOeTQwTmpjZ01DQXdJREFnTGpneUxTNDBNRGxzTFM0MU16RXRNUzQ0TkRnZ01TNHpPRGN1T1RFMFlTNDFNekV1TlRNeElEQWdNQ0F3SUM0M01USXRMamMzTVd3dE1TNDFOakV0TWk0d01ESmpMUzR3T1RFdExqRXhOaTB1TVRrMUxTNHlNak10TGpJM09TMHVNelExTFM0eE1pMHVNVGMyTFM0eU5EUXRMalEyTlMwdU1EUTJMUzQzTlRNdU1Ua3lMUzR5T0M0ek5pMHVNemcyTGpRMk1pMHVOREkzTGpBMk9DMHVNREkyTGpFME15MHVNREkyTGpJeE5pMHVNRE5zTGpreU55MHVNRFE1WVM0MU56a3VOVGM1SURBZ01DQXdJQzR5TXpNdE1TNHdPU0F5TnpNdU15QXlOek11TXlBd0lEQWdNUzB6TGpBMU9DMHhMalU1TnlBM0xqTXpPQ0EzTGpNek9DQXdJREFnTUMweExqTXhOaTB1TlRReklERXVOVFUzSURFdU5UVTNJREFnTUNBeExTNDROek10TGpZME5Gb2lJR1pwYkd3OUlpTTVOa00wUlVNaUlDOCtDaUFnSUNBOGNHRjBhQ0JqYkdGemN6MGlabWxzYkVOc2N6TWlJR1E5SW0wME9TNHdNU0EwTnk0ME5qWWdOUzR3TXpJZ01TNHdNRFZ6TGpFNU15MHlMak16TlM0ek16VXRNeTQ0TkRaakxqQTJOUzB1TmprMExqRXpOUzB4TGpVME5pNHhPVFV0TWk0ek1UWmhNaTQwT0RRZ01pNDBPRFFnTUNBd0lEQXRNUzQ1TVMweUxqWXhNV010TVM0ME9EUXRMak0xTFRJdU9UTXlMalk1T1MwekxqQTNPU0F5TGpJeE5pMHVNRFUxTGpVMk55MHVNVEV5SURFdU1UTTVMUzR4TmpZZ01TNDJNekZoTmpBMkxqWXdOeUEyTURZdU5qQTNJREFnTUNBd0xTNDBNRGNnTXk0NU1qRmFiVFF1T0RreklESXVNRGd4TFRVdU1EUTJMUzQ1TlRsekxTNHhNalVnTVM0Mk9USXRMakkyTnlBeUxqYzJNbU10TGpFMklERXVNakF5TGpZNU15QXlMakk1TnlBeExqZzVNaUF5TGpRNE5td3VPRGsxTGpFME1XTXhMakUwTlM0eE9DQXlMakl6T0MwdU5UazBJREl1TXpZMExURXVOelEyTGpFeE15MHhMakEwTXk0eE5qSXRNaTQyT0RRdU1UWXlMVEl1TmpnMFdpSWdabWxzYkQwaUl6UkdPVUpGTXlJZ0x6NEtJQ0FnSUR4d1lYUm9JR05zWVhOelBTSm1hV3hzUTJ4ek55SWdaRDBpVFRVNExqTTVPQ0F6TWk0MU5UUmpNQzB4TGpJeE9DMHhMakF6TlMweUxqTTJOaTB4TGpBek5TMHlMak0yTm5NdE15NHlNemtnTXk0ek5Ea3ROaTR5TVNBMExqRTBZeTB6TGpFNU9DNDROVEV0T0M0ME1qY3RMamc0TnkwNExqUXlOeTB1T0RnM2N5MHVNalUySURFdU1qY2dNQ0F5TGpJeE9HTXVNVGszTGpjeklEUXVOVGcwSURFdU9UUTRJRGd1T0RjeExqY3pPU0F6TGpZNU55MHhMakEwTkNBMkxqZ3dNUzB5TGprMU55QTJMamd3TVMwekxqZzBORm9pSUdacGJHdzlJaU16TXpRNVFVUWlMejRLSUNBZ0lEeHdZWFJvSUdOc1lYTnpQU0ptYVd4c1EyeHpOQ0lnWkQwaVRUVTRMakV3TWlBeU5TNDNOVE5qTFM0eU1Ua3ROQzQzTXpndE5DNHlPREV0T0M0ek16a3RPUzR3TVRrdE9DNHhNekl0TlM0ek1qTXVNak15TFRndU1qZ2dNeTQxTkRndE9DNHlPQ0E0TGpjeU15QXdJRFV1TVRjMUxqVTVNaUF4TUM0MU1UUWdNVEF1TmpRMUlEZ3VNVE15SURVdU1Ea3hMVEV1TWpBM0lEY3VNRGszTFRNdU5qazJJRFl1TmpVMExUZ3VOekl6V2lJZ1ptbHNiRDBpSXpWRE5rVkNPU0lnTHo0S0lDQWdJRHh3WVhSb0lHTnNZWE56UFNKbWFXeHNRMnh6TlNJZ1pEMGlUVFE0TGpjNE9DQXpNaTQxTlRSak15NDJPVGN0TGpZeE5pQXlMamd3T1MwMUxqRTNOU0F5TGpnd09TMDFMakUzTlMwdU1UUTRMUzQwTXpRdE1pNDRNRGt0TGpVNU1TMDJMalF6TVMweExqZHpMVE11TnpjeExUSXVORFF0TkM0d05qWXRNaTR5T1RKakxTNDBORFFnTWk0d055MHhMakF6TlNBMExqVTRNeUF3SURjdU1qUTFJREV1TURjMElERXVORGM0SURNdU9Ua3lJREl1TlRNNElEY3VOamc0SURFdU9USXlXaUlnWm1sc2JEMGlJek5EUXpBNU9TSWdMejRLSUNBZ0lEeHdZWFJvSUdOc1lYTnpQU0ptYVd4c1EyeHpOaUlnWkQwaWJUUTVMak01SURJM0xqYzBPQzB6TGpJM0xTNDROekpqTFM0MU5qSXRMakUxTFM0NU9UVXVOREl4TFM0Mk5ESXVPRGd6TGpZeE1TNDNPVGNnTVM0ME9USWdNUzQyTnpVZ01pNDBNVElnTVM0Mk9ERXVOVFl1TURBMElERXVNVGszTFM0ek1UTWdNUzQzTURrdExqWTBOUzQwTkRFdExqSTROUzR5T1RrdExqa3hNUzB1TWpBNUxURXVNRFEzV2lJZ1ptbHNiRDBpSTBVeFJrWkdOaUl2UGdvZ0lDQWdQSEJoZEdnZ1kyeGhjM005SW1acGJHeERiSE14SWlCa1BTSk5NVGt1TURFNUlERXlMall6Tm1NdU5ERTRMVEV1TURrNUlERXVPVFV5TFRFdU1UVTNJREl1TkRVeUxTNHdPVE5zTVM0ek5qY2dNaTQ1TURkakxqSXhOQzQwTlRNdU5qWXpMamMwT1NBeExqRTJOQzQzTmpWc01pNDVPRFl1TURrMVl6RXVNVGcxTGpBek9DQXhMamN6TlNBeExqUTRPQzQ0TnpNZ01pNHpNREpzTFRJdU5ETTFJREl1TWprNFlURXVNek15SURFdU16TXlJREFnTUNBd0xTNHpOVFlnTVM0ek56TnNMamMyTVNBeUxqTTVPV011TXpjeElERXVNVFkyTFM0NE9UUWdNaTR4TnpRdE1TNDVORGdnTVM0MU5USnNMVEl1TkRVMUxURXVORFZoTVM0ek16UWdNUzR6TXpRZ01DQXdJREF0TVM0ME5ERXVNRFUxYkMweUxqTXpPQ0F4TGpZek1XTXRNUzR3TURNdU55MHlMak0wTVMwdU1qQTVMVEl1TURZdE1TNDBiQzQxTnpndE1pNDBOV0V4TGpNek5DQXhMak16TkNBd0lEQWdNQzB1TkRVNUxURXVNelF5YkMweUxqWXdNUzB5TGpFd04yTXRMamt5TWkwdU56UTNMUzQwT0RNdE1pNHlNelV1TmprMkxUSXVNell5YkRJdU9UWTVMUzR6TWpGaE1TNHpNeUF4TGpNeklEQWdNQ0F3SURFdU1UQXpMUzQ0TlRGc01TNHhORFF0TXk0d01ERmFJaUJtYVd4c1BTSWpSa1pDT1RWQ0lpOCtDaUFnSUNBOGNHRjBhQ0JqYkdGemN6MGlabWxzYkVOc2N6SWlJR1E5SWsweU15NDVOU0F5TVM0eE5qRmpMakk1TmlBd0lERXVNek14TGpreE55QXhMak16TVM0NU1UZHNNaTQxTVRNZ05DNHlOVGh6TFRJdU5ERXhMUzQ1TnprdE15NDBMVEl1TWpFNFl5MHVOREl4TFM0MU1qWXRMamd5TFM0NE1EZ3RMamc0TnkweExqUTNPQzB1TURZeExTNDJMakUwTnkweExqUTNPUzQwTkRNdE1TNDBOemxhSWlCbWFXeHNQU0lqT1RaRE5FVkRJaTgrQ2lBZ1BDOW5QZ29nSUR4d1lYUm9JR05zWVhOelBTSm1hV3hzTVNJZ1pEMGlUVGt4TGpNME9TQTFNQzQyT0RsaExqTXpOQzR6TXpRZ01DQXdJREVnTGpVek1pNHpNRGRzTFM0eE5pQXhMakk0WVM0ek16SXVNek15SURBZ01DQXdJQzR4TkRRdU16RTNiREV1TURFeExqWTRNMkV1TXpNekxqTXpNeUF3SURBZ01TMHVNVEl4TGpZd00yd3RNUzR6TVRZdU1qWTBZUzR6TXpRdU16TTBJREFnTUNBd0xTNHlOVGd1TWpRemJDMHVNamM0SURFdU1EWXpZUzR6TXpNdU16TXpJREFnTUNBeExTNDJNVGd1TURZNGJDMHVOVFEyTFRFdU1EWTFZUzR6TXpVdU16TTFJREFnTUNBd0xTNHpNVE10TGpFNE1Xd3RNUzR4T1RRdU1EWmhMak16TXk0ek16TWdNQ0F3SURFdExqSTFNUzB1TlRkc0xqYzRNaTB1TnpjeVlTNHpNelV1TXpNMUlEQWdNQ0F3SUM0d09ERXRMak0wTkd3dExqUXlPUzB4TGpJM01tRXVNek0wTGpNek5DQXdJREFnTVNBdU5EWXlMUzQwTURkc01TNHdPVFl1TlRNMVlTNHpNekl1TXpNeUlEQWdNQ0F3SUM0ek5EY3RMakF6Tkd3eExqQXlPUzB1TnpjNFdpSWdabWxzYkQwaUkyWm1aaUlnYzNSNWJHVTlJbUZ1YVcxaGRHbHZiaTFrZFhKaGRHbHZiam8wY3p0aGJtbHRZWFJwYjI0NllYTjBjbTl1WVhWME1TMXlhV2RvZEMxemRHRnlJRFJ6SURJd01HMXpJR2x1Wm1sdWFYUmxJaTgrQ2lBZ1BIQmhkR2dnWTJ4aGMzTTlJbVpwYkd3eElpQmtQU0pOTVRFdU16TTVJRFk1TGpjek5XRXVNek16TGpNek15QXdJREFnTVNBdU5UazNMUzR4TkRSc0xqTXhMalF5WXk0d056VXVNVEF4TGpJdU1UVXlMak15TkM0eE16RnNMalEyTnkwdU1EYzVZUzR6TXpNdU16TXpJREFnTUNBeElDNHpNamd1TlRKc0xTNHpNVGd1TkRVMFlTNHpNeTR6TXlBd0lEQWdNQzB1TURFNUxqTTFNbXd1TVRjM0xqTXlNbUV1TXpNekxqTXpNeUF3SURBZ01TMHVOREF5TGpRM05Xd3RMalF3TkMwdU1UUXhZUzR6TXpJdU16TXlJREFnTUNBd0xTNHpOVEl1TURnMWJDMHVNamsxTGpNeFlTNHpNek11TXpNeklEQWdNQ0F4TFM0MU56VXRMakkwYkM0d01USXRMak0yTm1FdU16TTJMak16TmlBd0lEQWdNQzB1TVRjNExTNHpNRFZzTFM0ME9URXRMakkxT0dFdU16TTBMak16TkNBd0lEQWdNU0F1TURVMUxTNDJNVE5zTGpRMU1TMHVNVFF6WVM0ek16SXVNek15SURBZ01DQXdJQzR5TWpndExqSTJOR3d1TURnMUxTNDFNVFphSWlCbWFXeHNQU0lqWm1abUlpQnpkSGxzWlQwaVlXNXBiV0YwYVc5dUxXUjFjbUYwYVc5dU9qUnpPMkZ1YVcxaGRHbHZianBoYzNSeWIyNWhkWFF4TFhKcFoyaDBMWE4wWVhJZ05ITWdOREF3YlhNZ2FXNW1hVzVwZEdVaUx6NEtJQ0E4WnlCemRIbHNaVDBpWVc1cGJXRjBhVzl1TFdSMWNtRjBhVzl1T2pSek8yRnVhVzFoZEdsdmJqcGhjM1J5YjI1aGRYUXhMWEpwWjJoMExYTjBZWElnTkhNZ01YTWdhVzVtYVc1cGRHVWlQZ29nSUNBZ1BIQmhkR2dnWTJ4aGMzTTlJbVpwYkd4RGJITXhNQ0lnWkQwaVRUZ3hMak14TlNBek55NHlOemRqTFM0ME56WWdNUzR6TURndU5pQXpMakF6TlNBeExqUXhOQ0EwTGpBNE5pNDBNamN1TlRVeklERXVNakUyTGpVNU1pQXhMamN5TlM0eE1UUXVOakl6TFM0MU9EUWdNUzQwTVRVdE1TNHpPQ0F4TGpnNE9DMHlMakExTnk0eE5EVXRMakl3Tnk0eU9EY3RMalEwTXk0ME1qTXRMalk1TVM0M056SXRNUzQwTVRFdExqSXdOaTB6TGpBM09DMHhMamd4TlMwekxqQTFNUzB4TGpVME1TNHdNalV0TXk0eE9EVXVNell5TFRNdU5qTTFJREV1TlRrNVdpSWdabWxzYkQwaUl6VTJRME5CT1NJdlBnb2dJQ0FnUEhCaGRHZ2dZMnhoYzNNOUltWnBiR3hEYkhNeE1TSWdaRDBpVFRneUxqYzVNeUEwTUM0M01EWjJMamN4Y3kwdU5EZzBMUzQxTmpJdExqY3pPQzB1T1RZeFl5MHVNell5TFM0MU5qWXRMamMwTFRFdU5UVXlMUzQzTkMweExqVTFNaTQ0Tmk0eE56SWdNUzQwTnpndU9USTNJREV1TkRjNElERXVPREF6V20weUxqWTJNUzB6TGpJNE1tRXVPRGczTGpnNE55QXdJREFnTVMwdU9EZzNMamc0Tnk0NE9EY3VPRGczSURBZ01DQXhMUzQ0T0RjdExqZzROeTQ0T0RjdU9EZzNJREFnTUNBeElERXVOemMwSURCNklpQm1hV3hzUFNJak1qWTVORGN6SWk4K0NpQWdQQzluUGdvZ0lEeHdZWFJvSUdOc1lYTnpQU0ptYVd4c01UQWlJSFJ5WVc1elptOXliVDBpY205MFlYUmxLREUxSURFeE9DNHhOak1nTXpVdU5ERTRLU0lnWm1sc2JEMGlJelUyUTBOQk9TSWdjM1I1YkdVOUltRnVhVzFoZEdsdmJpMWtkWEpoZEdsdmJqbzBjenRoYm1sdFlYUnBiMjQ2WVhOMGNtOXVZWFYwTVMxeWFXZG9kQzF6ZEdGeUlEUnpJRFl3TUcxeklHbHVabWx1YVhSbElpQmtQU0pOT0RBdU9Ua3pJREl6TGpZeE1tRXlMakl4T0NBeExqTXpNU0F3SURBZ01TMHlMakl4T0NBeExqTXpJREl1TWpFNElERXVNek14SURBZ01DQXhMVEl1TWpFM0xURXVNek1nTWk0eU1UZ2dNUzR6TXpFZ01DQXdJREVnTkM0ME16VWdNSG9pTHo0S0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JERXdJaUIwY21GdWMyWnZjbTA5SW5KdmRHRjBaU2d0TVRVZ01UQTNMalF5T1NBeE1Ua3VOVEl6S1NJZ1ptbHNiRDBpSXpVMlEwTkJPU0lnYzNSNWJHVTlJbUZ1YVcxaGRHbHZiaTFrZFhKaGRHbHZiam8wY3p0aGJtbHRZWFJwYjI0NllYTjBjbTl1WVhWME1TMXlhV2RvZEMxemRHRnlJRFJ6SURNd01HMXpJR2x1Wm1sdWFYUmxJaUJrUFNKTk56VXVNRFkzSURjNUxqWTRNbUV6TGpRME55QXhMak16TVNBd0lEQWdNUzB6TGpRME9DQXhMak16TVNBekxqUTBOeUF4TGpNek1TQXdJREFnTVMwekxqUTBOeTB4TGpNek1TQXpMalEwTnlBeExqTXpNU0F3SURBZ01TQTJMamc1TlNBd2VpSXZQZ29nSUR4bklHTnNZWE56UFNKbWFXeHNNU0lnYzNSNWJHVTlJbUZ1YVcxaGRHbHZiaTFrZFhKaGRHbHZiam8wY3p0aGJtbHRZWFJwYjI0NllYTjBjbTl1WVhWME1TMXlhV2RvZEMxemRHRnlJRFJ6SURFeU1EQnRjeUJwYm1acGJtbDBaU0krQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JFTnNjekV3SWlCa1BTSk5OaTQ1TVRJZ05URXVOelkzWXkwdU5UVXpJREV1TVRReklEQWdNeTR5TlRNZ01DQXpMakkxTTNNeUxqYzJNU0F4TGpNNU9TQTBMalkxT0NBeExqa3lNbU14TGprNU5TNDFORGtnTlM0eU5EZ3VOek01SURVdU1qUTRMamN6T1hNeExqazVOUzB5TGpFeE1TQXhMamMzTkMwekxqWTVObU10TGpFeU15MHVPRGczTFRRdU16QXhMVE11T0RJMUxUWXVOVEExTFRRdU1qZzRMVEl1TkRNdExqVXhNUzAwTGpZM05DQXhMakF6TlMwMUxqRTNOU0F5TGpBM1dpSWdabWxzYkQwaUl6VTJRME5CT1NJdlBnb2dJQ0FnUEhCaGRHZ2dZMnhoYzNNOUltWnBiR3hEYkhNeE1TSWdaRDBpVFRrdU56SWdOVFF1TlRjMll5MHVPRGd0TGpJMExUSXVNakUzTGpjek9TMHlMakl4Tnk0M016bHpNUzQwTWpFdU5qZ2dNaTR6TmpVZ01TNHdNelZqTVM0d016VXVORFEwSURFdU56YzBMalU1TWlBeExqYzNOQzQxT1RKekxTNHlPVFV0TVM0NU1qSXRNUzQ1TWpJdE1pNHpOalphSWlCbWFXeHNQU0lqTWpZNU5EY3pJaTgrQ2lBZ0lDQThjR0YwYUNCamJHRnpjejBpWm1sc2JFTnNjekV4SWlCbWFXeHNQU0lqTWpZNU5EY3pJaUJrUFNKTk16RXVORE00SURVMExqa3dNV0V4TGprNE1pQXhMakV5T1NBek1DNHlNRElnTUNBeExUSXVNamd6TFM0d01qRWdNUzQ1T0RJZ01TNHhNamtnTXpBdU1qQXlJREFnTVMweExqRTBOQzB4TGprM05DQXhMams0TXlBeExqRXpJRE13TGpJd01pQXdJREVnTXk0ME1qY2dNUzQ1T1RWNklpOCtDaUFnUEM5blBnbzhMM04yWno0OGRHVjRkQ0I0UFNJeU5UQWlJSGs5SWpNeU1DSWdjM1I1YkdVOUluUmxlSFF0WVc1amFHOXlPbTFwWkdSc1pUdG1hV3hzT25kb2FYUmxPMlp2Ym5RdGMybDZaVG94TkhCNElqN2x2WlBsaVkza3ZiL25sS2pvZ0lYdnZKb2dJakI0TVdJeFptUmtNMlk0TkdJeU1ERTVZbVZtTkRjNU16bGxOalptWWpZeE9UUTFNekptT1RZME1DSThMM1JsZUhRK1BIUmxlSFFnZUQwaU1qVXdJaUI1UFNJek5EQWlJSE4wZVd4bFBTSjBaWGgwTFdGdVkyaHZjanB0YVdSa2JHVTdabWxzYkRwM2FHbDBaVHRtYjI1MExYTnBlbVU2TVRSd2VDSSs1WWl3NXB5ZjVwZWxPaUFnNVl5WDVMcXM1cGUyNVl5Njc3eUlRMU5VNzd5SklESXdNalBsdWJRNDVweUlNalhtbDZVNDVwZTJQQzkwWlhoMFBqeDBaWGgwSUhnOUlqSTFNQ0lnZVQwaU5EQXdJaUJ6ZEhsc1pUMGlkR1Y0ZEMxaGJtTm9iM0k2Yldsa1pHeGxPMlpwYkd3NmQyaHBkR1U3Wm05dWRDMXphWHBsT2pRMmNIZ2lQdVdrcCtXU2x1bUJreUFqTUR3dmRHVjRkRDQ4ZEdWNGRDQjRQU0l5TlRBaUlIazlJalEyTUNJZ2MzUjViR1U5SW5SbGVIUXRZVzVqYUc5eU9tMXBaR1JzWlR0bWFXeHNPbmRvYVhSbE8yWnZiblF0YzJsNlpUbzBNSEI0SWo3bnA1L2xnSi9rdUswOEwzUmxlSFErUEM5emRtYysiLCAiZGVzaWduZXIiOiAiZHJ6dS54eXoiLCAiYXR0cmlidXRlcyI6IFt7InRyYWl0X3R5cGUiOiAi5b2T5YmN55So5oi3IiwgInZhbHVlIjogIjB4MWIxZmRkM2Y4NGIyMDE5YmVmNDc5MzllNjZmYjYxOTQ1MzJmOTY0MCJ9LHsidHJhaXRfdHlwZSI6ICLliLDmnJ/ml6UiLCAidmFsdWUiOiAi5YyX5Lqs5pe25Yy677yIQ1NU77yJIDIwMjPlubQ45pyIMjXml6U45pe2In0seyJ0cmFpdF90eXBlIjogIueKtuaAgSIsICJ2YWx1ZSI6ICLnp5/lgJ/kuK0ifV19"}
            if (dataAsset.contains("http")) {
                //url的方式
                String resultUrl = HttpClientUtil.doGet(dataAsset);
                JSONObject jsonObjectUrl = JSONObject.parseObject(resultUrl);
                jsonObjectUrl.getString("name");
                result = resultUrl;
            } else if (dataAsset.contains("base64")) {
                /**
                 * base64的方式
                 */
                String base64String = OpenApiUtils.base64(dataAsset);
                result = base64String;
            }

        }
        return result;
    }

    @Override
    public String queryDetails() {
        String result = null;

        Map<String, String> params = new HashMap<>();
        Uint256 tokenId = new Uint256(Integer.valueOf("1"));
        /**
         * 参考abi.例如
         *
         [方法readCall] tokenURI:
         [入参uint256] tokenId:
         [出参string] :
         *
         *
         * 解释分析:
         *  调用api为readCall
         * 	方法名字为 tokenURI
         * 	入参一个tokenId,类型为uint256
         * 	返回一个string类型字符
         *
         */
        Function uriParm = new Function(
                "tokenURI",
                Arrays.asList(tokenId),
                Collections.emptyList()
        );
        String abiEncodedDatauri = DefaultFunctionEncoder.encode(uriParm);
        //链的id ,具体查看对应链的文档 文昌测试12231 文昌正式1223  数图测试 1 数图正式1029
        params.put("chainid", "12231");
        //编码后的数据
        params.put("data", abiEncodedDatauri);
        //会员手机号
        params.put("id", "18518517787");
        //合约地址
        params.put("contract", "0xc87b56dd0000000000000000000000000000000000000000000000000000000000000002");
        //头部
        Map<String, String> headerMap = OpenApiUtils.makeHeaders(params);
        String postResult = OpenApiUtils.getRequest(ApiConstant.READCALL, headerMap, params);
        log.info("--uri的基本详情{}", postResult);
        JSONObject jsonObjectErrcode = JSONObject.parseObject(postResult);
        // 状态码，0成功，其他失败
        if (Objects.nonNull(jsonObjectErrcode) && jsonObjectErrcode.containsKey("code")
                && "0".equals(jsonObjectErrcode.getString("code"))) {
            String data = jsonObjectErrcode.getString("data");
            //返回结果例子.需要先解码
            //{"success":true,"code":"0","data":"0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000269646174613a6170706c69636174696f6e2f6a736f6e3b6261736536342c65794a755957316c496a6f674975576b6a2b615870655751672b65546e4f57746f2b5747737557566969416a4d69497349434a6b5a584e6a636d6c7764476c766269493649434c6e6c712f6e69344c6c70492f6d6c36587676497a6c6872446e694c336b7549446b7549766a674949694c434169615731685a3255694f6941696148523063484d364c79397a4d79356a6269317562334a30614330784c6d467459587076626d46336379356a62323075593234765a6d6c735a5335706332393062334175644739774c7a49774d6a4d774f4441794c7a45324f5441354e5449334d44417a4e444a664d5463324c6e42755a79497349434a6b5a584e705a32356c6369493649434a7063323930623341756447397749697767496d463064484a70596e56305a584d694f69426265794a30636d4670644639306558426c496a6f6749756d6268755734677557467065576375755334752b656c71434973496e5a686248566c496a6f674975573373756167754f6d5567434a394c48736964484a686158526664486c775a53493649434c6c6b49506e6b357a6d6a4a486d694a67694c434a32595778315a53493649434c6c74374c6d6f4c6a706c49416966537837496e527959576c3058335235634755694f694169355a476f364c363535346947355a4f4249697769646d4673645755694f6941693562657935714334365a5341496e307365794a30636d4670644639306558426c496a6f674975614a6b2b574e6f6565566d65572f74534973496e5a686248566c496a6f674975573373756167754f6d5567434a395858303d0000000000000000000000000000000000000000000000"}
            //看abi返回结果是string,需要string类型解码(Utf8String 为web3j的jar包属性,不可为java的String)
            TypeReference stringTypeReference = TypeReference.create(Utf8String.class);
            List<Type> list = DefaultFunctionReturnDecoder.decode(data, Arrays.asList(stringTypeReference));
            String dataAsset = String.valueOf(list.get(0).getValue());
            log.info("解码后的数据=={}", dataAsset);
            if (StringUtils.isNotBlank(dataAsset)) {
                if (dataAsset.contains("http")) {
                    //url的方式
                    String resultUrl = HttpClientUtil.doGet(dataAsset);
                    JSONObject jsonObjectUrl = JSONObject.parseObject(resultUrl);
                    jsonObjectUrl.getString("name");
                    result = resultUrl;
                } else if (dataAsset.contains("base64")) {
                    /**
                     * 案例如下:
                     data:application/json;base64,eyJuYW1lIjogIuWkj+aXpeWQg+eTnOWto+WGsuWViiAjMiIsICJkZXNjcmlwdGlvbiI6ICLnlq/ni4LlpI/ml6XvvIzlhrDniL3kuIDkuIvjgIIiLCAiaW1hZ2UiOiAiaHR0cHM6Ly9zMy5jbi1ub3J0aC0xLmFtYXpvbmF3cy5jb20uY24vZmlsZS5pc290b3AudG9wLzIwMjMwODAyLzE2OTA5NTI3MDAzNDJfMTc2LnBuZyIsICJkZXNpZ25lciI6ICJpc290b3AudG9wIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogIumbhuW4guWFpeWcuuS4u+elqCIsInZhbHVlIjogIuW3suaguOmUgCJ9LHsidHJhaXRfdHlwZSI6ICLlkIPnk5zmjJHmiJgiLCJ2YWx1ZSI6ICLlt7LmoLjplIAifSx7InRyYWl0X3R5cGUiOiAi5ZGo6L6554iG5ZOBIiwidmFsdWUiOiAi5bey5qC46ZSAIn0seyJ0cmFpdF90eXBlIjogIuaJk+WNoeeVmeW/tSIsInZhbHVlIjogIuW3suaguOmUgCJ9XX0=
                     * base64的方式,解析后如下
                     * {"name": "夏日吃瓜季冲啊 #2", "description": "疯狂夏日，冰爽一下。", "image": "https://s3.cn-north-1.amazonaws.com.cn/file.isotop.top/20230802/1690952700342_176.png", "designer": "isotop.top", "attributes": [{"trait_type": "集市入场主票","value": "已核销"},{"trait_type": "吃瓜挑战","value": "已核销"},{"trait_type": "周边爆品","value": "已核销"},{"trait_type": "打卡留念","value": "已核销"}]}
                     */
                    String base64String = OpenApiUtils.base64(dataAsset);
                    result = base64String;
                }
            }
        }
        return result;
    }
}